<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./s4g400_files/filelist.xml">
<link rel=Edit-Time-Data href="./s4g400_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>SQLConnect(), SQLDisconnect(), SQLStringConnect()</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Subject>Hacker's Guide for Visual FoxPro 98</o:Subject>
  <o:Author>Tamar E. Granor</o:Author>
  <o:Keywords>s4g reference</o:Keywords>
  <o:Template>HACK7S4.DOT</o:Template>
  <o:LastAuthor>Doug Hennig</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:LastPrinted>1601-01-01T00:00:00Z</o:LastPrinted>
  <o:Created>2002-04-25T16:28:00Z</o:Created>
  <o:LastSaved>2002-04-25T16:28:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1354</o:Words>
  <o:Characters>7719</o:Characters>
  <o:Category>Reference Section</o:Category>
  <o:Manager>Whil Hentzen (ha!)</o:Manager>
  <o:Company>T &amp; T</o:Company>
  <o:Bytes>51712</o:Bytes>
  <o:Lines>64</o:Lines>
  <o:Paragraphs>15</o:Paragraphs>
  <o:CharactersWithSpaces>9479</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
 <o:CustomDocumentProperties>
  <o:Generator dt:dt="string">Microsoft Word 97</o:Generator>
  <o:Version dt:dt="string">8.0.3410</o:Version>
  <o:Date dt:dt="string">10/11/96</o:Date>
  <o:UnknownHead_0_1_0 dt:dt="string">&lt;LINK REL=stylesheet TYPE=&quot;text/css&quot; HREF=&quot;HackFox.css&quot;&gt;&#13;&#13;</o:UnknownHead_0_1_0>
 </o:CustomDocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DoNotHyphenateCaps/>
  <w:DrawingGridHorizontalSpacing>5.5 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>14.95 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:DoNotShadeFormData/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	layout-grid-mode:line;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
strong
	{mso-bidi-font-weight:normal;}
em
	{mso-bidi-font-style:normal;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	background:navy;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	layout-grid-mode:line;}
p.DefinitionTerm, li.DefinitionTerm, div.DefinitionTerm
	{mso-style-name:"Definition Term";
	mso-style-next:"Definition List";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
p.DefinitionList, li.DefinitionList, div.DefinitionList
	{mso-style-name:"Definition List";
	mso-style-next:"Definition Term";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.Definition
	{mso-style-name:Definition;
	mso-style-parent:"";
	font-style:italic;}
p.H1, li.H1, div.H1
	{mso-style-name:H1;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:24.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:18.0pt;
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H2, li.H2, div.H2
	{mso-style-name:H2;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H3, li.H3, div.H3
	{mso-style-name:H3;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H4, li.H4, div.H4
	{mso-style-name:H4;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H5, li.H5, div.H5
	{mso-style-name:H5;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H6, li.H6, div.H6
	{mso-style-name:H6;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Address, li.Address, div.Address
	{mso-style-name:Address;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.Blockquote, li.Blockquote, div.Blockquote
	{mso-style-name:Blockquote;
	margin-top:5.0pt;
	margin-right:.25in;
	margin-bottom:5.0pt;
	margin-left:.25in;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.CITE
	{mso-style-name:CITE;
	mso-style-parent:"";
	font-style:italic;}
span.CODE
	{mso-style-name:CODE;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Keyboard
	{mso-style-name:Keyboard;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	font-weight:bold;}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:0in 47.95pt 95.9pt 143.85pt 191.8pt 239.75pt 287.7pt 335.65pt 383.6pt 431.55pt 479.5pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.Sample
	{mso-style-name:Sample;
	mso-style-parent:"";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Typewriter
	{mso-style-name:Typewriter;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Variable
	{mso-style-name:Variable;
	mso-style-parent:"";
	font-style:italic;}
span.HTMLMarkup
	{mso-style-name:"HTML Markup";
	mso-style-parent:"";
	color:red;
	display:none;
	mso-hide:all;}
span.Comment
	{mso-style-name:Comment;
	mso-style-parent:"";
	display:none;
	mso-hide:all;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:1.0in;
	mso-footer-margin:1.0in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:370050148;}
@list l0:level1
	{mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:1926010502;}
@list l1:level1
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:238299232;}
@list l2:level1
	{mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l3
	{mso-list-id:-129;
	mso-list-type:simple;
	mso-list-template-ids:293106064;}
@list l3:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:-128;
	mso-list-type:simple;
	mso-list-template-ids:-2066472834;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5
	{mso-list-id:-127;
	mso-list-type:simple;
	mso-list-template-ids:1704226658;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6
	{mso-list-id:-126;
	mso-list-type:simple;
	mso-list-template-ids:-970583376;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:-2068936872;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8
	{mso-list-id:-120;
	mso-list-type:simple;
	mso-list-template-ids:-368676784;}
@list l8:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l9
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:-608800772;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=H2>SQLConnect(), SQLDisconnect(), SQLStringConnect()<o:p></o:p></p>

<p class=MsoNormal>These functions are the first and last ones you'll need to
use SQL Pass-Through (the client-server mode in which you send commands
directly to the back end). SQLConnect() and SQLStringConnect() let you hook up
with remote data via ODBC. SQLDisconnect() closes a connection opened by one of
the others. Think of SQLConnect() and SQLStringConnect() as dialing a phone and
SQLDisconnect() as hanging up the phone.<o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'>Usage<span class=CODE><span
  style='font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=Preformatted>nConnectionHandle = SQLConnect( cDataSource [, cUserId
  [, <o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun:
  yes">                                </span>cPassword ] ] )<o:p></o:p></p>
  <p class=Preformatted>nConnectionHandle = SQLConnect( [ cNamedConnection ] )<o:p></o:p></p>
  <p class=Preformatted>nConnectionHandle = SQLStringConnect( [
  cConnectionString ] )<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=H6><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=256 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Parameter<o:p></o:p></b></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Value<o:p></o:p></b></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Meaning<o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=256 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>cDataSource<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Character<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>The name of a data source as seen in the ODBC
  Administrator.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>cUserId<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Character<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>The user ID with which to log in to the server.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>cPassword<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Character<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>The password with which to log in to the server.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 rowspan=2 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>cNamedConnection<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Character<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>A named connection from the current database.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Omitted<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Presents an ODBC dialog allowing the user to choose which
  ODBC Connection or Data Source to use.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 rowspan=2 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>cConnectionString<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Character<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>A complete connection string, as needed to connect to the
  desired server. Specify the data source by including
  &quot;dsn=cDataSource&quot; in the string or leave it out and specify the
  driver name and other connection information to use a &quot;DSN-less&quot;
  connection.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Omitted<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>A different dialog box than the one above is presented,
  allowing the operator to choose among file and machine data sources.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 rowspan=3 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>nConnectionHandle<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>–1<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Connection attempt failed at the connection level.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>–2<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Connection attempt failed at the environment level.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Positive Number<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Connection succeeded and can be accessed through
  nConnectionHandle.<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>Continuing the phone analogy, using SQLConnect() with a
named connection is like pushing your speed dial button. Using SQLConnect()
with a separate data source, user ID and password is like pushing all the
buttons yourself. Using SQLStringConnect() is like calling the operator and
giving her all the information.<o:p></o:p></p>

<p class=MsoNormal>If you omit the parameters, the two functions behave
slightly differently. SQLConnect() brings up the &quot;Select Connection or
DataSource&quot; dialog, letting you pick either. However, SQLStringConnect()
offers the SQL Data Sources dialog, letting you choose from the existing ODBC
data sources. Pressing Cancel in either dialog aborts the process, returning –1
to indicate no connection was established.<o:p></o:p></p>

<p class=MsoNormal>Be sure to hold on to the return value of these functions.
The return value is your key to doing anything useful. All the other SQL
Pass-Through functions take the connection handle as the first parameter. If
you lose track of your connection handles, there's no way to find out what
handles are out there, short of trying to use one and trapping for an error.
The example at the end of this section remedies this problem—it shows a
connection manager class that keeps track of connections for you. You
instantiate the class once, and then let it manage all your connections. Using
this class, you'd never call SQLConnect() or SQLStringConnect() yourself.<o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'>Usage<span class=CODE><span
  style='font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=Preformatted style='margin-top:6.0pt'>nReturnValue = SQLDisconnect(
  nConnectionHandle )<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=H6><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=256 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Parameter<o:p></o:p></b></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Value<o:p></o:p></b></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Meaning<o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=256 rowspan=2 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>nConnectionHandle<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Positive<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>The connection handle for the connection to be closed.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>0<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Close all open connections.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 rowspan=2 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>nReturnValue<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>1<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Connection successfully closed.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>–1<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Connection level error.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>–2 <o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Environmental error.<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>SQLDisconnect() is the function to hang up the phone. You
pass the handle and FoxPro says &quot;goodbye&quot; for you.<o:p></o:p></p>

<p class=MsoNormal>The documentation says this function returns a negative
value when it can't close the connection. We haven't seen that in practice. Our
experience is that, if something's going at on our end that prevents us from
closing the connection (like an asynchronous command is still executing), we
get an error message, not a return value of –1.<o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'><img width=95 height=77
  id="_x0000_i1025" src="..\..\..\..\HackGIFs\bug.gif"><o:p></o:p></p>
  </td>
  <td width=660 style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal style='margin-right:-.75pt'>This is a documentation bug.
  There appears to be an error in the help topic for SQLDisconnect; it states
  &quot;Use SQLCONNECT(<i>nConnectionHandle</i>) to reconnect to existing
  handles without generating duplicates.&quot; However, you get a
  &quot;Function argument value, type, or count is invalid&quot; error when you
  pass a numeric value to SQLCONNECT.<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=H6><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'>Example<span class=CODE><span
  style='font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=Preformatted>* We recommend you use something like the Connection
  Manager<o:p></o:p></p>
  <p class=Preformatted>* class shown here to manage your connections. This
  solves<o:p></o:p></p>
  <p class=Preformatted>* the problem of there being no way to find out what
  connections<o:p></o:p></p>
  <p class=Preformatted>* exist. You'll probably want to beef this class up, at
  least <o:p></o:p></p>
  <p class=Preformatted>* with a custom error handler.<o:p></o:p></p>
  <p class=Preformatted>* We created this class as a visual class. The code
  shown here<o:p></o:p></p>
  <p class=Preformatted>* was exported by the Class Browser. You'll find this
  class<o:p></o:p></p>
  <p class=Preformatted>* in the Downloads as Connect.VCX.<o:p></o:p></p>
  <p class=Preformatted>**************************************************<o:p></o:p></p>
  <p class=Preformatted>*-- Class:<span style="mso-spacerun: yes">       
  </span>connmgr (h:\hacker\testcode\connect.vcx)<o:p></o:p></p>
  <p class=Preformatted>*-- ParentClass:<span style="mso-spacerun: yes"> 
  </span>custom<o:p></o:p></p>
  <p class=Preformatted>*-- BaseClass:<span style="mso-spacerun: yes">   
  </span>custom<o:p></o:p></p>
  <p class=Preformatted>*-- Connection Manager. Used to keep track of all
  active <o:p></o:p></p>
  <p class=Preformatted>*-- connections.<o:p></o:p></p>
  <p class=Preformatted>*<o:p></o:p></p>
  <p class=Preformatted>DEFINE CLASS connmgr AS custom<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>*-- The
  number of open connections<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>PROTECTED
  nconnectioncount<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">  
  </span>nconnectioncount = 0<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>Name =
  &quot;connmgr&quot;<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>*-- Holds the
  open connections<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>PROTECTED
  aconnections[1]<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>*-- Open a
  connection<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>PROCEDURE
  openconnection<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* Open a
  connection - based on parameters<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">     
  </span>LPARAMETERS cSource, cUserId, cPassword<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>*
  cSource is either datasource name or named connection<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>LOCAL
  nHandle<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>DO CASE<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>CASE
  NOT EMPTY(DBC()) AND ;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>INDBC(cSource, &quot;CONNECTION&quot;)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">            </span>*
  named connection - go for it<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>nHandle = SQLCONNECT(cSource)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>CASE
  TYPE(&quot;cUserId&quot;) = &quot;C&quot; AND TYPE(&quot;cPassword&quot;) =
  &quot;C&quot;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">  </span><span
  style="mso-spacerun: yes">          </span>nHandle = SQLCONNECT(cSource,
  cUserId, cPassword)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>CASE
  TYPE(&quot;cUserId&quot;) = &quot;C&quot;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>nHandle = SQLCONNECT(cSource, cUserId)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>CASE
  TYPE(&quot;cPassword&quot;) = &quot;C&quot;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>nHandle = SQLCONNECT(cSource, &quot;&quot;, cPassword)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>OTHERWISE<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>nHandle = SQLCONNECT(cSource)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>ENDCASE<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>IF nHandle
  &gt; 0<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>*
  successful connection<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>* so
  add this connection to our list<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>This.nConnectionCount = This.nConnectionCount+1<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>DIMENSION This.aConnections[This.nConnectionCount, 4]<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>This.aConnections[This.nConnectionCount,1] = nHandle<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>This.aConnections[This.nConnectionCount,2] = cSource<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>This.aConnections[This.nConnectionCount,3] = cUserId<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>This.aConnections[This.nConnectionCount,4] = cPassword<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>ENDIF<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>RETURN
  nHandle<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>ENDPROC<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>*-- Close an
  open connection<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>PROCEDURE
  closeconnection<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* Close an
  open connection. Make sure to remove it from <o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* the open
  list<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">     
  </span>LPARAMETERS nHandle<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>* Which
  connection to close<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* Find out
  if we have such a connection<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>LOCAL
  nConnectionRow, nResult<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">     
  </span>nConnectionRow = ASCAN(This.aConnections, nHandle, -1, ;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>-1, 1,
  8)<span style="mso-spacerun: yes">      </span><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>IF
  nConnectionRow &gt; 0<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>* Found
  it, now get rid of it<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>nResult
  = SQLDISCONNECT(nHandle)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>ADEL(This.aConnections, nConnectionRow)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>This.nConnectionCount = This.nConnectionCount-1<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>IF
  This.nConnectionCount &gt; 0<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>DIMENSION This.aConnections[This.nConnectionCount,4]<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span><span
  style="mso-spacerun: yes">      </span>ENDIF<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>ELSE<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>* Turn
  off the error handler and send the code for<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>* error
  we want. This lets AERROR() return the right<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>*
  information, but keeps the user from seeing a <o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>*
  message.<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>LOCAL
  cOldError<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        </span><span
  style="mso-spacerun: yes"> </span>cOldError=ON(&quot;ERROR&quot;)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>ON
  ERROR *<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>ERROR
  1466<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>ON
  ERROR &amp;cOldError<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>nResult
  = -2<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>ENDIF<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>RETURN
  nResult<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>ENDPROC<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>*-- List all
  open connections<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>PROCEDURE
  list<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* List the
  open connections in the active window<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">     
  </span>?&quot;Connection handle&quot;, ;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      
  </span>&quot;Data
  Source/Connection&quot;,&quot;Userid&quot;,&quot;Password&quot;<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>IF
  This.nConnectionCount&gt;0<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>LOCAL
  nConn<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>FOR
  nConn = 1 TO This.nConnectionCount<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">            </span>?
  This.aConnections[nConn, 1]<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">            </span>??
  This.aConnections[nConn, 2] AT 19<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">            </span>IF
  TYPE(&quot;This.aConnections[nConn, 3]&quot;) = &quot;C&quot;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">              
  </span>?? This.aConnections[nConn, 3] AT 42<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>ENDIF<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">            </span>IF
  TYPE(&quot;This.aConnections[nConn, 4]&quot;) = &quot;C&quot;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">              
  </span>?? This.aConnections[nConn, 4] AT 49<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>ENDIF<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>ENDFOR<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>ELSE<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>?
  &quot;No Open Connections&quot;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>ENDIF<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>ENDPROC<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>PROCEDURE
  count<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* Return
  the number of connections<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>RETURN
  This.nConnectionCount<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>ENDPROC<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>PROCEDURE
  aconnect<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* Return
  an array containing all active connection <o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>*
  information.<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* Since
  we're already storing it in an array, <o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>* this is
  as simple as copying the array<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>PARAMETER
  aReturn<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>EXTERNAL
  ARRAY aReturn<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>LOCAL
  nReturn<span style="mso-spacerun: yes">   </span>&amp;&amp; Return value is #
  of rows or -1<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>DO CASE <o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>CASE
  TYPE(&quot;aReturn[1]&quot;) = &quot;U&quot;<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>* Bad
  parameter, can't do it<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>nReturn = -1<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">         </span>CASE
  This.nConnectionCount = 0<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>nReturn = 0<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">        
  </span>OTHERWISE<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">            </span>*
  Redim the array to get rid of old data<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>DIMENSION aReturn[1]<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">            </span>*
  Copy from the property into the parameter<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>ACOPY(This.aConnections, aReturn)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">           
  </span>nReturn = ALEN(aReturn, 1)<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>ENDCASE<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">      </span>RETURN
  nReturn<o:p></o:p></p>
  <p class=Preformatted><span style="mso-spacerun: yes">   </span>ENDPROC<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted>ENDDEFINE<o:p></o:p></p>
  <p class=Preformatted>*<o:p></o:p></p>
  <p class=Preformatted>*-- EndDefine: connmgr<o:p></o:p></p>
  <p class=Preformatted>**************************************************<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=H6><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'><span style='color:black'>See Also<o:p></o:p></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Create Connection, SQLExec(), SQLGetProp(), SQLSetProp()<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
