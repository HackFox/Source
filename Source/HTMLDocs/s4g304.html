<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./s4g304_files/filelist.xml">
<link rel=Edit-Time-Data href="./s4g304_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Menus</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Subject>Hacker's Guide for Visual FoxPro 98</o:Subject>
  <o:Author>Tamar E. Granor</o:Author>
  <o:Keywords>s4g reference</o:Keywords>
  <o:Template>hack7s4.dot</o:Template>
  <o:LastAuthor>Doug Hennig</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>3</o:TotalTime>
  <o:LastPrinted>1601-01-01T00:00:00Z</o:LastPrinted>
  <o:Created>2002-04-25T16:27:00Z</o:Created>
  <o:LastSaved>2002-04-25T16:27:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>1788</o:Words>
  <o:Characters>10195</o:Characters>
  <o:Category>Reference Section</o:Category>
  <o:Manager>Whil Hentzen (ha!)</o:Manager>
  <o:Company>T &amp; T</o:Company>
  <o:Bytes>40448</o:Bytes>
  <o:Lines>84</o:Lines>
  <o:Paragraphs>20</o:Paragraphs>
  <o:CharactersWithSpaces>12520</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
 <o:CustomDocumentProperties>
  <o:Generator dt:dt="string">Microsoft Word 97</o:Generator>
  <o:Version dt:dt="string">8.0.3410</o:Version>
  <o:Date dt:dt="string">10/11/96</o:Date>
  <o:UnknownHead_0_1_0 dt:dt="string">&lt;LINK REL=stylesheet TYPE=&quot;text/css&quot; HREF=&quot;HackFox.css&quot;&gt;&#13;&#13;</o:UnknownHead_0_1_0>
 </o:CustomDocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DoNotHyphenateCaps/>
  <w:DrawingGridHorizontalSpacing>5.5 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>14.95 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:DoNotShadeFormData/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	layout-grid-mode:line;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
strong
	{mso-bidi-font-weight:normal;}
em
	{mso-bidi-font-style:normal;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	background:navy;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	layout-grid-mode:line;}
p.DefinitionTerm, li.DefinitionTerm, div.DefinitionTerm
	{mso-style-name:"Definition Term";
	mso-style-next:"Definition List";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
p.DefinitionList, li.DefinitionList, div.DefinitionList
	{mso-style-name:"Definition List";
	mso-style-next:"Definition Term";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.Definition
	{mso-style-name:Definition;
	mso-style-parent:"";
	font-style:italic;}
p.H1, li.H1, div.H1
	{mso-style-name:H1;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:24.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:18.0pt;
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H2, li.H2, div.H2
	{mso-style-name:H2;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H3, li.H3, div.H3
	{mso-style-name:H3;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H4, li.H4, div.H4
	{mso-style-name:H4;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H5, li.H5, div.H5
	{mso-style-name:H5;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H6, li.H6, div.H6
	{mso-style-name:H6;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Address, li.Address, div.Address
	{mso-style-name:Address;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.Blockquote, li.Blockquote, div.Blockquote
	{mso-style-name:Blockquote;
	margin-top:5.0pt;
	margin-right:.25in;
	margin-bottom:5.0pt;
	margin-left:.25in;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.CITE
	{mso-style-name:CITE;
	mso-style-parent:"";
	font-style:italic;}
span.CODE
	{mso-style-name:CODE;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Keyboard
	{mso-style-name:Keyboard;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	font-weight:bold;}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:0in 47.95pt 95.9pt 143.85pt 191.8pt 239.75pt 287.7pt 335.65pt 383.6pt 431.55pt 479.5pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.Sample
	{mso-style-name:Sample;
	mso-style-parent:"";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Typewriter
	{mso-style-name:Typewriter;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Variable
	{mso-style-name:Variable;
	mso-style-parent:"";
	font-style:italic;}
span.HTMLMarkup
	{mso-style-name:"HTML Markup";
	mso-style-parent:"";
	color:red;
	display:none;
	mso-hide:all;}
span.Comment
	{mso-style-name:Comment;
	mso-style-parent:"";
	display:none;
	mso-hide:all;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:1.0in;
	mso-footer-margin:1.0in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:370050148;}
@list l0:level1
	{mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:1926010502;}
@list l1:level1
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:238299232;}
@list l2:level1
	{mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l3
	{mso-list-id:-129;
	mso-list-type:simple;
	mso-list-template-ids:293106064;}
@list l3:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:-128;
	mso-list-type:simple;
	mso-list-template-ids:-2066472834;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5
	{mso-list-id:-127;
	mso-list-type:simple;
	mso-list-template-ids:1704226658;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6
	{mso-list-id:-126;
	mso-list-type:simple;
	mso-list-template-ids:-970583376;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:-2068936872;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8
	{mso-list-id:-120;
	mso-list-type:simple;
	mso-list-template-ids:-368676784;}
@list l8:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l9
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:-608800772;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=H2>Menus<o:p></o:p></p>

<p class=MsoNormal>FoxPro has four—count 'em, four—different kinds of menus,
not including those you might hand-build with a form (like putting up a series
of buttons with choices). Why this embarrassment of riches? Historical reasons,
of course. Each time a new type of menu became common, the next version of
FoxBase/FoxPro included it. The number of menu commands in the language is
staggering.<o:p></o:p></p>

<p class=MsoNormal>However, other than for testing purposes, we haven't
actually written a menu command in years. We build our menus using the Menu
Designer and let it generate all the code we need. With the addition of Andrew
Ross MacNeill's GenMenuX, there's not much we can't do with generated menus.
So, our first piece of advice is: Don't write menu code.<o:p></o:p></p>

<p class=MsoNormal>So what kinds of menus can you build, anyway? The antique
varieties come in three flavors: Lotus-style lightbar menus, individual
(somewhat ugly) menu popups, and an array-based precursor to Windows-type
menus. They're all quirky and tedious to create and, most important, none of
them fully conforms to the Windows interface standard. Don't use them.<o:p></o:p></p>

<p class=H3>The Real McCoy<o:p></o:p></p>

<p class=MsoNormal>So what's left? Component-style, Windows-type menus.
Coincidentally, exactly the kind the Menu Designer lets you create.<o:p></o:p></p>

<p class=MsoNormal>Windows menus are built out of four types of components:
menu bars, pads, popups and bars. That's right—the term &quot;bar&quot; has two
different meanings in this context. (So what else is new?) The &quot;menu
bar&quot; refers to the one line across the top of a window that contains the
main options for that window or application. The term &quot;bar&quot; is used
for individual items in a menu popup—things like &quot;New&quot; or
&quot;Open&quot; or &quot;Print.&quot; In between those two levels, we have
pads—the items that appear on the menu bar—like &quot;File,&quot;
&quot;Edit,&quot; and &quot;Help&quot;; and we have popups, which appear when
you choose a menu pad. The popups contain the actual menu items (or bars) that
you can choose to do something. Figure 1 shows the Visual FoxPro menu bar. It
has eight pads at this point. The Window pad has been chosen, opening the
window popup. The popup has 12 bars, including the three horizontal divider
bars.<o:p></o:p></p>

<p class=MsoNormal><img width=409 height=160 id="_x0000_i1025"
src="..\WORDDOCS\s4g304a.gif"><o:p></o:p></p>

<p class=H4>Figure 1: A Windows menu is composed of four types of components: a
menu bar, pads, popups and bars. You shouldn't hang out in bars.<o:p></o:p></p>

<p class=MsoNormal>Component menus actually break down into two pairs of
containers and contents. A menu bar without pads or a popup without bars is
like an Oreo cookie without the cream.<o:p></o:p></p>

<p class=MsoNormal>A menu may have many, many levels, but there's always one
menu bar with a collection of pads. Those pads have popups, each of which
contains bars. The bars, however, may point to more popups, which in turn have
more bars, and so forth and so on and scooby-dooby-dooby. Generally, it's not a
good idea to have more than two levels of popups and bars. Users don't appreciate
having to navigate down, down, down. It's very easy to get lost, and be unable
to find a particular bar again without trolling through the entire menu
structure. In addition, users with motor challenges will have a much harder
time trying to keep all the menus open. If there are that many choices, call a
dialog and let them make all the choices in parallel.<o:p></o:p></p>

<p class=H3>Are Shortcuts and Hot Keys Anything like Cold Cuts and Hotcakes?<o:p></o:p></p>

<p class=MsoNormal>Menu pads and bars (the contained objects) have a number of
characteristics in common. Each has a prompt (the text that appears for it).
The prompt can include a &quot;hot key,&quot; a single letter that's
underlined, which the user can press to choose that item when focus is on the
container (the menu bar or popup). In addition, a keyboard shortcut, which
chooses the item at any time, can be included. Each item may also have a
message that appears in the status bar when the item is highlighted. A
&quot;skip for&quot; condition may be specified, indicating that the item is
disabled under certain conditions. Beginning in VFP 7, menu bars may also
include an icon.<o:p></o:p></p>

<p class=MsoNormal>The difference between menu hot keys and menu shortcuts is a
little subtle. Hot keys are available only when focus is already on the menu.
You press just the underlined key. In Figure 1, hot keys are active only for
the bars of the Window menu. &quot;C&quot; is the hot key for the Command
Window.<o:p></o:p></p>

<p class=MsoNormal>Shortcuts are available when the menu doesn't have focus.
They usually are either Alt or Ctrl plus a key or a function key. Typically,
Alt plus a key is used for menu pad shortcuts, while Ctrl plus a key is used
for menu bar shortcuts. In Figure 1, Ctrl+F2 is the shortcut for the
Window-Command Window bar. Alt+F is the shortcut for the File pad.<o:p></o:p></p>

<p class=MsoNormal>When you specify a menu, either in code or in the Menu
Designer, you have to specify hot keys and shortcuts separately. Hot keys are
specified by preceding the letter with &quot;\&lt;&quot; in the prompt.
Shortcuts are specified with the KEY clause of the appropriate command or
through the Options dialog in the Menu Designer.<o:p></o:p></p>

<p class=MsoNormal>In most applications, some menu options shouldn't be
available some of the time. When an item isn't available, the user should be
aware of it; usually, unavailable options are dimmed. FoxPro handles some of
this automatically. When a modal form is active, almost all menu items are
dimmed. (Only things like Edit-Copy are available.) Most of what needs to be
done, though, is under your control. The SKIP FOR clause of the various menu
commands or the SKIP FOR check box in the Options dialog of the Menu Designer
lets you specify a condition for dimming the item. Pay attention to the name of
this clause—it's SKIP FOR, not ALLOW FOR. That is, the condition you specify
should be .T. when the item is to be dimmed. This is one of those
counter-intuitive things, like SET DELETED, that makes FoxPro so, er,
idiosyncratically lovable, and just has to be accepted because &quot;it's
always been that way.&quot;<o:p></o:p></p>

<p class=MsoNormal>Recent versions of Windows permit icons next to the text on
menu bars. VFP has adopted this practice, beginning in version 7, using the
PICTURE and PICTRES clauses of DEFINE BAR. In the Menu Designer, you specify
these in the Options dialog for the bar.<o:p></o:p></p>

<p class=MsoNormal>VFP 7 also introduced the ability to create so-called MRU
(&quot;most recently used&quot;) bars and to invert bars as desired. For
details, check out the DEFINE BAR section.<o:p></o:p></p>

<p class=H3>The Font of Knowledge<o:p></o:p></p>

<p class=MsoNormal>Since Windows-style menus entered the language, they've had
mostly incremental change. There are a couple of newer features worth looking
at. First, we have control over the font used for each menu component. Now we
can make menus that look like ransom notes. Alternate fonts, however, are not
available in menus that replace the system menu. Because this is the kind the
Menu Designer is meant to build, you have no font choices there. (Besides, as
with so many other items, the only person who should change the font for system
menus is the user.)<o:p></o:p></p>

<p class=MsoNormal>Also, to accommodate various ActiveX issues, each menu pad
can specify how it behaves when a different application takes over. Any pad can
disappear or stick around in any of three specified locations. Similarly, each
menu pad can indicate what happens to it when it's used in an ActiveDocument.<o:p></o:p></p>

<p class=H3>Handmade Isn't Always Better<o:p></o:p></p>

<p class=MsoNormal>Building a menu in code is a tremendous undertaking. (If you
don't believe us, open the Menu Designer, specify a Quick Menu, then Generate
it. Take a look at the code.) You have to DEFINE each component with the
appropriate command. Then, for each pad and bar, you have to specify the
appropriate ON command to indicate what happens when the user chooses that item.<o:p></o:p></p>

<p class=MsoNormal>Menu DEFINE commands, though long-winded, are pretty
straightforward. You indicate what item you're specifying, then provide each
piece of information about it, such as the prompt, the message, the skip for
condition, the shortcut, and so on.<o:p></o:p></p>

<p class=MsoNormal>The commands that indicate what happens when the user does
something are more complex. They come in two flavors: ON and ON SELECTION. The
ON commands are simpler—you use them to nest menus. Use ON PAD, for example, to
indicate which popup to activate when the user chooses a particular menu pad.<o:p></o:p></p>

<p class=MsoNormal>The ON SELECTION version specifies a command to execute when
the user chooses that item. These are cool because they propagate downward.
That is, if you specify an ON SELECTION for a popup, it applies to any of that
popup's bars that don't have actions of their own. This is particularly handy
when you're first building an application. Specify something like WAIT WINDOW
&quot;Not implemented yet&quot; at a high level, then fill in the individual
items as you go.<o:p></o:p></p>

<p class=H3>Designer Menus<o:p></o:p></p>

<p class=MsoNormal>Almost everything you can do in code, you can do in the Menu
Designer much more easily. Definitions go into the Prompt text box, plus a few
of the Options items. For pads and bars, the ON vs. ON SELECTION choice is
incorporated into the Result type drop-down list. A result type of
&quot;Submenu&quot; corresponds to ON, while a result type of &quot;Command or
Procedure&quot; is really ON SELECTION. (The final result type, &quot;Pad
Name&quot; or &quot;Bar #&quot;, lets you build components of Visual FoxPro's
own menu right into your application menus.)<o:p></o:p></p>

<p class=MsoNormal>For the menu bar itself and menu popups, you can specify a
routine to run ON SELECTION in the Menu Options dialog on the View menu.<o:p></o:p></p>

<p class=MsoNormal>Menus built in the Menu Designer are stored in tables with
extensions of MNX/MNT. To turn a menu into something you can use, you have to
generate the menu (either from Menu-Generate or through the Project Manager).
This runs a program whose name is stored in _GENMENU, typically GENMENU.PRG
(written in FoxPro), which reads the MNX table and uses textmerge to create the
program, with an MPR extension, that implements your design. (The
aforementioned GENMENUX uses the _GENMENU variable to hook itself into the
process. You change _GENMENU to point to GENMENUX, then it calls GENMENU when
it's ready to.)<o:p></o:p></p>

<p class=H3>Who's In Charge Here?<o:p></o:p></p>

<p class=MsoNormal>Once you have a menu defined, then what? You have to tell
FoxPro to use your menu. There are a couple of ways to do this. <o:p></o:p></p>

<p class=MsoNormal>The Windows way (and the approach normally used by the Menu
Designer) is to define your menu pads as belonging to _MSYSMENU, the system
menu. Combined with SET SYSMENU AUTOMATIC, that's all it takes to let your menu
replace FoxPro's.<o:p></o:p></p>

<p class=MsoNormal>Occasionally, you might have a reason to do it a different
way (though we haven't in a long time). In that case, you use ACTIVATE MENU to
start things rolling. <o:p></o:p></p>

<p class=H3>Shortcuts Again?<o:p></o:p></p>

<p class=MsoNormal>In the wonderful, but sometimes confusing, world of FoxPro,
it's normal to have two (or more) meanings for the same or similar phrases.
Menus include yet another example. As we said above, a menu shortcut is a key
combination that executes a menu bar without navigating to it (like Ctrl+C for
Copy). In the last few years, shortcut menus have come into vogue. No, these
aren't menu items that substitute for a key combination, as the phrase might
make you think. Shortcut menus are also known as context menus or right-click
menus. They're the popups that appear when you right-click somewhere.<o:p></o:p></p>

<p class=MsoNormal>In VFP 5 and later, you can create shortcut menus in the
Menu Designer. Simply choose Shortcut from the dialog that appears when you
CREATE MENU and you're on your way. The generated menu starts at the popup
level and goes down from there. To hook it to right-clicks, put code like: <o:p></o:p></p>

<p class=Preformatted>DO MyShortCut.MPR<o:p></o:p></p>

<p class=MsoNormal>in the RightClick event of the relevant object. If you want
a context menu that appears on all right-clicks, not just on a particular
object, use something like:<o:p></o:p></p>

<p class=Preformatted>ON KEY LABEL RightMouse DO MyShortCut.MPR<o:p></o:p></p>

<p class=MsoNormal>(In either case, don't forget to trigger your context menu
when the user presses Shift+F10 or the special context menu key on the
keyboard, as well.) <o:p></o:p></p>

<p class=MsoNormal>Just like standard menus, the shortcut menus you create in
the Menu Designer can use the system menu bars. So, for example, to put a copy
item in a shortcut menu, you specify the result as &quot;Bar #&quot; and the
action (ever noticed that column in the Menu Designer is unlabeled?) as
&quot;_MED_COPY&quot;. (Lose the quotes in both places.)<o:p></o:p></p>

<p class=MsoNormal>In VFP 3, you have to write your own DEFINE POPUP and DEFINE
BAR code for shortcut menus. Then, in the RightClick event for whatever
triggers the popup (or with ON KEY LABEL RightMouse), use ACTIVATE POPUP.<o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'><span style='color:black'>See Also<o:p></o:p></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>@ ... Prompt, Activate Popup, Activate Menu, Create Menu,
  Define Bar, Define Menu, Define Pad, Define Popup, Menu, Menu To, _GenMenu,
  On Bar, On Exit Bar, On Exit Menu, On Exit Pad, On Exit Popup, On Pad, On
  Selection Bar, On Selection Menu, On Selection, Pad(), On Selection Popup,
  Read Menu, Set SysMenu, Set TextMerge<b style='mso-bidi-font-weight:normal'><span
  style='color:red'><o:p></o:p></span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
