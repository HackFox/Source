<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./s4g877_files/filelist.xml">
<title>XMLUpdateGram()</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Subject>Hacker's Guide for Visual FoxPro 98</o:Subject>
  <o:Author>Tamar E. Granor</o:Author>
  <o:Keywords>s4g reference</o:Keywords>
  <o:Template>HACK7S4.DOT</o:Template>
  <o:LastAuthor>Doug Hennig</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>0</o:TotalTime>
  <o:LastPrinted>1601-01-01T00:00:00Z</o:LastPrinted>
  <o:Created>2002-04-25T16:32:00Z</o:Created>
  <o:LastSaved>2002-04-25T16:32:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>861</o:Words>
  <o:Characters>4909</o:Characters>
  <o:Category>Reference Section</o:Category>
  <o:Manager>Whil Hentzen (ha!)</o:Manager>
  <o:Company>T &amp; T</o:Company>
  <o:Bytes>33280</o:Bytes>
  <o:Lines>40</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>6028</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
 <o:CustomDocumentProperties>
  <o:Generator dt:dt="string">Microsoft Word 97</o:Generator>
  <o:Version dt:dt="string">8.0.3410</o:Version>
  <o:Date dt:dt="string">10/11/96</o:Date>
  <o:UnknownHead_0_1_0 dt:dt="string">&lt;LINK REL=stylesheet TYPE=&quot;text/css&quot; HREF=&quot;HackFox.css&quot;&gt;&#13;&#13;</o:UnknownHead_0_1_0>
 </o:CustomDocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DoNotHyphenateCaps/>
  <w:DrawingGridHorizontalSpacing>5.5 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>14.95 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:DoNotShadeFormData/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	layout-grid-mode:line;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
strong
	{mso-bidi-font-weight:normal;}
em
	{mso-bidi-font-style:normal;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	background:navy;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	layout-grid-mode:line;}
p.DefinitionTerm, li.DefinitionTerm, div.DefinitionTerm
	{mso-style-name:"Definition Term";
	mso-style-next:"Definition List";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
p.DefinitionList, li.DefinitionList, div.DefinitionList
	{mso-style-name:"Definition List";
	mso-style-next:"Definition Term";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.Definition
	{mso-style-name:Definition;
	mso-style-parent:"";
	font-style:italic;}
p.H1, li.H1, div.H1
	{mso-style-name:H1;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:24.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:18.0pt;
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H2, li.H2, div.H2
	{mso-style-name:H2;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H3, li.H3, div.H3
	{mso-style-name:H3;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H4, li.H4, div.H4
	{mso-style-name:H4;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H5, li.H5, div.H5
	{mso-style-name:H5;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H6, li.H6, div.H6
	{mso-style-name:H6;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Address, li.Address, div.Address
	{mso-style-name:Address;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.Blockquote, li.Blockquote, div.Blockquote
	{mso-style-name:Blockquote;
	margin-top:5.0pt;
	margin-right:.25in;
	margin-bottom:5.0pt;
	margin-left:.25in;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.CITE
	{mso-style-name:CITE;
	mso-style-parent:"";
	font-style:italic;}
span.CODE
	{mso-style-name:CODE;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Keyboard
	{mso-style-name:Keyboard;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	font-weight:bold;}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:0in 47.95pt 95.9pt 143.85pt 191.8pt 239.75pt 287.7pt 335.65pt 383.6pt 431.55pt 479.5pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.Sample
	{mso-style-name:Sample;
	mso-style-parent:"";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Typewriter
	{mso-style-name:Typewriter;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Variable
	{mso-style-name:Variable;
	mso-style-parent:"";
	font-style:italic;}
span.HTMLMarkup
	{mso-style-name:"HTML Markup";
	mso-style-parent:"";
	color:red;
	display:none;
	mso-hide:all;}
span.Comment
	{mso-style-name:Comment;
	mso-style-parent:"";
	display:none;
	mso-hide:all;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:1.0in;
	mso-footer-margin:1.0in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:370050148;}
@list l0:level1
	{mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:1926010502;}
@list l1:level1
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:238299232;}
@list l2:level1
	{mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l3
	{mso-list-id:-129;
	mso-list-type:simple;
	mso-list-template-ids:293106064;}
@list l3:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:-128;
	mso-list-type:simple;
	mso-list-template-ids:-2066472834;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5
	{mso-list-id:-127;
	mso-list-type:simple;
	mso-list-template-ids:1704226658;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6
	{mso-list-id:-126;
	mso-list-type:simple;
	mso-list-template-ids:-970583376;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:-2068936872;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8
	{mso-list-id:-120;
	mso-list-type:simple;
	mso-list-template-ids:-368676784;}
@list l8:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l9
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:-608800772;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=H2>XMLUpdateGram()<o:p></o:p></p>

<p class=MsoNormal>XMLUpdateGram(), available starting in VFP 7, is a way to
capture changes to the data in a set of tables in an XML format. SQL Server can
use XML updategrams to update data, eliminating the need for tedious coding
techniques to update SQL Server databases. <o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'>Usage<span class=CODE><span
  style='font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=Preformatted style='margin-top:6.0pt'>cUpdateGram = XMLUpdateGram( [
  cTableList [, nFlags ] ] )<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=H6><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=256 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Parameter<o:p></o:p></b></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Value<o:p></o:p></b></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Meaning<o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=256 rowspan=2 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>cTableList <o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Character<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>A list of tables and cursors to include in the updategram.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Omitted<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Uses all open tables and cursors in the current work session
  that have buffered changes.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 rowspan=5 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>nFlags<o:p></o:p></p>
  <p class=MsoNormal>Note: All flags are additive.<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>0 or omitted<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Unicode (UTF-8) formatted XML.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>1<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Generate unformatted XML, meaning that there are no extra
  tabs or carriage returns (no pretty-printing).<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>2<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Generate an opening and closing tag when the element is
  empty. If specified, an empty element reads: &lt;region&gt;&lt;/region&gt;;
  if omitted, only a &lt;region/&gt; tag is generated.<span style='color:windowtext'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>4<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Preserves white space in fields. If not specified, it
  trims trailing spaces.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>8<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Wraps memo fields in CDATA sections. CDATA sections are
  useful for memo fields that contain characters used in the markup language,
  such as &lt;, &gt;, &amp;, and &quot;. A CDATA session starts with
  &quot;&lt;![CDATA[&quot; and ends with &quot;]]&gt;&quot;. All characters are
  interpreted as character data instead of markup commands. <o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 rowspan=3 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Bits 4 and 5 are combined to set output encoding. Select
  only one value between 16 and 48.<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>16<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Sets the output encoding attribute to the code page of the
  cursor. (Default)<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>32<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Uses Unicode (UTF-8) output encoding; no character
  translation occurs and no &quot;encoding=&quot; attribute is contained in the
  XML declaration. <o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>48<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Uses Unicode (UTF-8) output encoding; double-byte
  characters are translated to Unicode, and no &quot;encoding=&quot; attribute
  is contained in the XML declaration.<o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=256 valign=top style='width:153.35pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>cUpdateGram<o:p></o:p></p>
  </td>
  <td width=180 valign=top style='width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>Character<o:p></o:p></p>
  </td>
  <td width=360 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>The resulting XML updategram string. Use STRTOFILE() to
  save the contents of this variable to a file.<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>First, some ground rules. The cursor(s) on which you're
tracking changes must be buffered, and MULTILOCKS must be set ON for
XMLUpdateGram() to work. You will probably want to use the View Designer or
CURSORSETPROP() to set the key field list, which limits the fields in the
before and after representations to the key fields and only those fields that
changed. If you don't specify key fields, all fields are listed in the before
and after representations, and you'll end up with a huge XML file. Warning: If
you have memo or general fields containing characters used in the markup
language (&lt;, &gt;, &amp;, and &quot;), you could generate errors unless you
include nFlags 8.<span style='color:windowtext'><o:p></o:p></span></p>

<p class=MsoNormal>So, what does an XML updategram look like? Here's the output
from the example code:<o:p></o:p></p>

<p class=Preformatted>&lt;?xml version = &quot;1.0&quot;
encoding=&quot;Windows-1252&quot; standalone=&quot;yes&quot;?&gt;<o:p></o:p></p>

<p class=Preformatted>&lt;root
xmlns:updg=&quot;urn:schemas-microsoft-com:xml-updategram&quot;&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes"> 
</span>&lt;updg:sync&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">   
</span>&lt;updg:before&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">     
</span>&lt;customer&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">      </span><span
style="mso-spacerun: yes">  </span>&lt;cust_id&gt;ALFKI&lt;/cust_id&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">       
</span>&lt;contact&gt;Maria Anders&lt;/contact&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">     
</span>&lt;/customer&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">   
</span>&lt;/updg:before&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">   
</span>&lt;updg:after&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">     
</span>&lt;customer&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">       
</span>&lt;cust_id&gt;ALFKI&lt;/cust_id&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">       
</span>&lt;contact&gt;none&lt;/contact&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">     
</span>&lt;/customer&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes">   
</span>&lt;/updg:after&gt;<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun: yes"> 
</span>&lt;/updg:sync&gt;<o:p></o:p></p>

<p class=Preformatted>&lt;/root&gt;<o:p></o:p></p>

<p class=MsoNormal>The first line is the declaration line, which defines some
specifics about the file. Then comes the root element, required in XML; it
defines this as an updategram. Then come &lt;updg:sync&gt; elements, each of
which is a transaction that can be committed, or is rolled back in the event of
a failure of any one of the elements contained. Each <i>sync</i> element
contains at least one pair of &lt;updg:before&gt; and &lt;updg:after&gt;
elements, which corresponds to an insert, update, or delete operation. Within
each <i>before</i> and <i>after</i> element is an element corresponding to each
<i>table</i> to be updated. It's conveniently named the same as the table to
update. And within these <i>table</i> elements are <i>field</i> elements, also
conveniently named identically to the fields they reference. In the <i>before</i>
element, these fields must identify one and only one record to update. If
you've used CURSORSETPROP() to specify a key fields list, the key fields as
well as the original values for those that fields that changed are listed. If
you did not specify a key fields list, all fields in the table are listed. The <i>after</i>
element contains the same fields, with the changed values. An element with an
empty <i>before</i> element represents an insert operation, while an empty <i>after</i>
element represents a delete operation.<o:p></o:p></p>

<p class=MsoNormal>Note that this function returns a character string. You must
save the character string to a file (STRTOFILE() is a good function to use),
which is the most common way to use updategrams.<o:p></o:p></p>

<p class=MsoNormal>Visual FoxPro can write updategrams, but it has no native
capacity to read them. You're entirely on your own if you want to incorporate
this into an application that uses only FoxPro tables. This is specifically
designed to update SQL Server tables. For example, your application may use
SQLEXEC() to execute a SELECT statement or stored procedure, which puts SQL
Server data into a FoxPro cursor. Your application allows the user to edit any
or all of the records in the cursor (after setting MULTILOCKS and buffering on,
and specifying a key fields list), then writes out the updategram when the user
is finished editing. Then, in SQL Server, execute the updategram file like any
other XML query template file.<o:p></o:p></p>

<p class=MsoNormal>Note that SQL Server 2000 supports updategrams only after
you have installed the XML for SQL Web Release, which can be freely downloaded
from msdn.microsoft.com. <o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'>Example<span class=CODE><span
  style='font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=Preformatted>LOCAL cUpdateGram <o:p></o:p></p>
  <p class=Preformatted>USE _SAMPLES + &quot;Data\customer.dbf&quot;<o:p></o:p></p>
  <p class=Preformatted>* Turn on MULTILOCKS and buffering.<o:p></o:p></p>
  <p class=Preformatted>SET MULTILOCKS ON<o:p></o:p></p>
  <p class=Preformatted>CURSORSETPROP(&quot;Buffering&quot;,5,&quot;customer&quot;)<o:p></o:p></p>
  <p class=Preformatted>CURSORSETPROP(&quot;KeyFieldList&quot;,&quot;cust_id&quot;,&quot;customer&quot;)
  <o:p></o:p></p>
  <p class=Preformatted>* Update some data.<o:p></o:p></p>
  <p class=Preformatted>REPLACE Customer.Contact WITH &quot;none&quot;<o:p></o:p></p>
  <p class=Preformatted>* Create updategram.<o:p></o:p></p>
  <p class=Preformatted>lcUpdateGram = XMLUPDATEGRAM(&quot;customer&quot;)<o:p></o:p></p>
  <p class=Preformatted>STRTOFILE(lcUpdateGram, &quot;NewUpdateGram.XML&quot;)<o:p></o:p></p>
  <p class=Preformatted>* Restore the record to its original form.<o:p></o:p></p>
  <p class=Preformatted>TABLEREVERT()<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=H6><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'><span style='color:black'>See Also<o:p></o:p></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>CursorSetProp(), CursorToXML(), Set MultiLocks, SQLExec(),
  StrToFile(), XMLToCursor(), VFPXMLProgID<span style='color:windowtext'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
