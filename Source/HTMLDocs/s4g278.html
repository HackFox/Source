<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./s4g278_files/filelist.xml">
<link rel=Edit-Time-Data href="./s4g278_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>CToT(), DToT(), TToC(), TToD()</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Subject>Hacker's Guide for Visual FoxPro 98</o:Subject>
  <o:Author>Tamar E. Granor</o:Author>
  <o:Keywords>s4g reference</o:Keywords>
  <o:Template>HACK7S4.DOT</o:Template>
  <o:LastAuthor>Doug Hennig</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:LastPrinted>1601-01-01T00:00:00Z</o:LastPrinted>
  <o:Created>2002-04-25T16:26:00Z</o:Created>
  <o:LastSaved>2002-04-25T16:26:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>804</o:Words>
  <o:Characters>4588</o:Characters>
  <o:Category>Reference Section</o:Category>
  <o:Manager>Whil Hentzen (ha!)</o:Manager>
  <o:Company>T &amp; T</o:Company>
  <o:Bytes>35328</o:Bytes>
  <o:Lines>38</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>5634</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
 <o:CustomDocumentProperties>
  <o:Generator dt:dt="string">Microsoft Word 97</o:Generator>
  <o:Version dt:dt="string">8.0.3410</o:Version>
  <o:Date dt:dt="string">10/11/96</o:Date>
  <o:UnknownHead_0_1_0 dt:dt="string">&lt;LINK REL=stylesheet TYPE=&quot;text/css&quot; HREF=&quot;HackFox.css&quot;&gt;&#13;&#13;</o:UnknownHead_0_1_0>
 </o:CustomDocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DoNotHyphenateCaps/>
  <w:DrawingGridHorizontalSpacing>5.5 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>14.95 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:DoNotShadeFormData/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	layout-grid-mode:line;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
strong
	{mso-bidi-font-weight:normal;}
em
	{mso-bidi-font-style:normal;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	background:navy;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	layout-grid-mode:line;}
p.DefinitionTerm, li.DefinitionTerm, div.DefinitionTerm
	{mso-style-name:"Definition Term";
	mso-style-next:"Definition List";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
p.DefinitionList, li.DefinitionList, div.DefinitionList
	{mso-style-name:"Definition List";
	mso-style-next:"Definition Term";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.Definition
	{mso-style-name:Definition;
	mso-style-parent:"";
	font-style:italic;}
p.H1, li.H1, div.H1
	{mso-style-name:H1;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:24.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:18.0pt;
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H2, li.H2, div.H2
	{mso-style-name:H2;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H3, li.H3, div.H3
	{mso-style-name:H3;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H4, li.H4, div.H4
	{mso-style-name:H4;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H5, li.H5, div.H5
	{mso-style-name:H5;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.H6, li.H6, div.H6
	{mso-style-name:H6;
	mso-style-next:Normal;
	margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Address, li.Address, div.Address
	{mso-style-name:Address;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.Blockquote, li.Blockquote, div.Blockquote
	{mso-style-name:Blockquote;
	margin-top:5.0pt;
	margin-right:.25in;
	margin-bottom:5.0pt;
	margin-left:.25in;
	mso-pagination:none;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.CITE
	{mso-style-name:CITE;
	mso-style-parent:"";
	font-style:italic;}
span.CODE
	{mso-style-name:CODE;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Keyboard
	{mso-style-name:Keyboard;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	font-weight:bold;}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:0in 47.95pt 95.9pt 143.85pt 191.8pt 239.75pt 287.7pt 335.65pt 383.6pt 431.55pt 479.5pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	layout-grid-mode:line;}
span.Sample
	{mso-style-name:Sample;
	mso-style-parent:"";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Typewriter
	{mso-style-name:Typewriter;
	mso-style-parent:"";
	mso-ansi-font-size:10.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";}
span.Variable
	{mso-style-name:Variable;
	mso-style-parent:"";
	font-style:italic;}
span.HTMLMarkup
	{mso-style-name:"HTML Markup";
	mso-style-parent:"";
	color:red;
	display:none;
	mso-hide:all;}
span.Comment
	{mso-style-name:Comment;
	mso-style-parent:"";
	display:none;
	mso-hide:all;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:1.0in;
	mso-footer-margin:1.0in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:370050148;}
@list l0:level1
	{mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:1926010502;}
@list l1:level1
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:238299232;}
@list l2:level1
	{mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l3
	{mso-list-id:-129;
	mso-list-type:simple;
	mso-list-template-ids:293106064;}
@list l3:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:-128;
	mso-list-type:simple;
	mso-list-template-ids:-2066472834;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5
	{mso-list-id:-127;
	mso-list-type:simple;
	mso-list-template-ids:1704226658;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6
	{mso-list-id:-126;
	mso-list-type:simple;
	mso-list-template-ids:-970583376;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:-2068936872;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8
	{mso-list-id:-120;
	mso-list-type:simple;
	mso-list-template-ids:-368676784;}
@list l8:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l9
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:-608800772;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=H2>CToT(), DToT(), TToC(), TToD()<o:p></o:p></p>

<p class=MsoNormal>These functions convert between dates and characters, and
datetimes. Like their predecessor functions DTOC() and CTOD(), each can be read
as &quot;something TO something.&quot; For example, DTOT() can be understood if
said as &quot;Date TO dateTime.&quot; CTOT() converts a Character string TO a
dateTime.<o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'>Usage<span class=CODE><o:p></o:p></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=Preformatted>tReturnValue = CTOT( cString )<o:p></o:p></p>
  <p class=Preformatted>tReturnValue = DTOT( dDate )<o:p></o:p></p>
  <p class=Preformatted>cReturnValue = TTOC( tDateTime [ , nFormat ] )<o:p></o:p></p>
  <p class=Preformatted>dReturnValue = TTOD( tDateTime )<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>CTOT() is pretty smart. If anything less than a full time
string is specified, it does its best to figure out what you mean, but it does
need some help from you. In particular, in VFP 3, CTOT() is unable to parse the
time segment without at least one colon. This was fixed in VFP 5. Here is what
it does under a variety of conditions:<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976&quot;)<span style="mso-spacerun:
yes">             </span>&amp;&amp; 07-04-1976 12:00:00 AM<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 &quot;)<span style="mso-spacerun:
yes">            </span>&amp;&amp; 07-04-1976 12:00:00 AM<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 1&quot;)<span style="mso-spacerun:
yes">           </span>&amp;&amp; In VFP 3, empty datetime variable<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun:
yes">                               </span>&amp;&amp; 07-04-1976 01:00:00 AM in
VFP 5 and later<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 12&quot;)<span style="mso-spacerun:
yes">          </span>&amp;&amp; In VFP 3, empty datetime variable<o:p></o:p></p>

<p class=Preformatted><span style="mso-spacerun:
yes">                               </span>&amp;&amp; 07-04-1976 12:00:00 PM in
VFP 5 and later<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 12:&quot;)<span
style="mso-spacerun: yes">         </span>&amp;&amp; 07-04-1976 12:00:00 PM<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 12:1&quot;)<span
style="mso-spacerun: yes">        </span>&amp;&amp; 07-04-1976 12:01:00 PM<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 12:11&quot;)<span
style="mso-spacerun: yes">       </span>&amp;&amp; 07-04-1976 12:11:00 PM<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 12:11:&quot;)<span
style="mso-spacerun: yes">      </span>&amp;&amp; 07-04-1976 12:11:00 PM<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 12:11:1&quot;)<span
style="mso-spacerun: yes">     </span>&amp;&amp; 07-04-1976 12:11:01 PM<o:p></o:p></p>

<p class=Preformatted>? CTOT(&quot;7/4/1976 12:11:11&quot;)<span
style="mso-spacerun: yes">    </span>&amp;&amp; 07-04-1976 12:11:11 PM<o:p></o:p></p>

<p class=MsoNormal>VFP 7 adds the capability to convert XML dates, in the
format &quot;yyyy-dd-mmThh:mm:ss&quot;. <o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'><img width=95 height=78
  id="_x0000_i1025" src="..\..\..\..\HackGifs\fixbug1.gif"><o:p></o:p></p>
  </td>
  <td width=660 style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>VFP 7 does indeed add the ability to convert XML dates;
  however, you must first issue:<o:p></o:p></p>
  <p class=Preformatted>SET DATE YMD<o:p></o:p></p>
  <p class=MsoNormal>Then you can try the following:<o:p></o:p></p>
  <p class=Preformatted>? CTOT(&quot;1976-07-04T12:11:11&quot;)<span
  style="mso-spacerun: yes">    </span>&amp;&amp; 07-04-1976 12:11:11 PM<o:p></o:p></p>
  <p class=MsoNormal>Microsoft says that this isn't a bug; it's an omission in
  the documentation. We think you shouldn't have to SET DATE before using a
  standard date format. And if this info is missing from the docs, then it's a
  bug in the docs. It's a bug. And it's another reason to keep up with the
  Service Packs; VFP 7 SP1 fixes this problem.<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=H6><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'><img width=95 height=78
  id="_x0000_i1026" src="..\..\..\..\HackGifs\fixbug1.gif"><o:p></o:p></p>
  </td>
  <td width=660 style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>This one's really a bug, although a short-lived bug. It
  was introduced in VFP 7 and fixed in SP1. In the original VFP 7 version, the
  XML date format allows fractional seconds, and the Help file says fractional
  seconds can be used. In fact, the Help file even gives an example. But try
  this (don't forget to SET DATE YMD first):<o:p></o:p></p>
  <p class=Preformatted>? CTOT(&quot;1976-07-04T12:11:11.555&quot;)<span
  style="mso-spacerun: yes">    </span>&amp;&amp; Empty!<o:p></o:p></p>
  <p class=MsoNormal>Seems to us that there's something of value there that can
  be parsed, and an empty date should not be returned. Fortunately, it's fixed
  in SP1.<span style='color:windowtext'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>DTOT() converts date to datetime values by setting the
datetime variable to the same date and setting the time to midnight. TTOC()
returns a character string, which respects the setting of SET CENTURY, SET
SECONDS and SET HOUR, so your return value can vary from 14 to 21 characters in
length. TTOD() converts a datetime to a date by truncating the time portion.<o:p></o:p></p>

<p class=MsoNormal>The two functions for converting characters to date and
datetimes are a potential source of ambiguous dates. Because the interpretation
of the string takes place at runtime, the settings in place at that time for
DATE and CENTURY can affect the interpretation of the string. If a routine is
called from more than one place, it is possible for the same line of code to
yield two different date values. For these reasons, SET STRICTDATE has a
special setting (2) just for detecting the CTOD() and CTOT() functions in code,
and flagging them as places where the potential for ambiguous dates exists. See
the section on SET STRICTDATE for details.<o:p></o:p></p>

<p class=MsoNormal>TTOC takes one optional parameter, starting in VFP 7. This
parameter changes the format of what's returned. Omitting the parameter
entirely returns the standard character string. A value of 2 returns only the
time portion of the string. According to the documentation, a value of 1 returns
a numeric string suitable for indexing (see the example below). In fact,
passing any value other than 2 returns this string.<o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'>Example<span class=CODE><span
  style='font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=Preformatted>SET STRICTDATE TO 0<span style="mso-spacerun: yes"> 
  </span><o:p></o:p></p>
  <p class=Preformatted>SET DATE TO MDY<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  <p class=Preformatted>? DTOT({^1995-04-01})<o:p></o:p></p>
  <p class=Preformatted>* Returns 04/01/1995 12:00:00am<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted>? TTOD({^1995-04-01 12:34:56p})<o:p></o:p></p>
  <p class=Preformatted>* Returns 04/01/1995<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted>? CTOT( &quot;9/28/1958 9:02&quot; )<o:p></o:p></p>
  <p class=Preformatted>* Triggers warning if StrictDate = 2<o:p></o:p></p>
  <p class=Preformatted>* Otherwise returns {09/28/58 09:02:00 AM}<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted>? TTOC({04/01/1995 12:00:00am})<o:p></o:p></p>
  <p class=Preformatted>* Returns &quot;04/01/1995 12:00:00am&quot;<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted>? TTOC({04/01/1995 12:00:00am}, 1)<o:p></o:p></p>
  <p class=Preformatted>* Returns &quot;19950104000000&quot;<o:p></o:p></p>
  <p class=Preformatted><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  <p class=Preformatted>? TTOC({04/01/1995 12:00:00am}, 2)<o:p></o:p></p>
  <p class=Preformatted>* Returns 12:00:00 AM<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>There's one conversion many folks feel is missing. There's
no function to convert a date and a time to a new datetime variable (for
example, the date and time in the third and fourth columns of an array filled
by ADIR()). There are two possibilities, both pretty simple. If the time is in
the format returned by SECONDS(), as the number of seconds since midnight, just
add the numeric seconds since midnight to the converted date-to-datetime. <o:p></o:p></p>

<p class=Preformatted>tNewDateTime = DTOT(dOldDate) + nTimeInSeconds<o:p></o:p></p>

<p class=MsoNormal>On the other hand, if you've stored the time in an
Hour:Minute:Second character string format, the following expression should
take care of your needs:<o:p></o:p></p>

<p class=Preformatted>tNewDateTime = CTOT(DTOC(dOldDate) + ' ' + cTimeInSeconds)<o:p></o:p></p>

<p class=H6><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<table border=0 cellspacing=0 cellpadding=0 width=796 style='width:477.35pt;
 margin-left:5.25pt;border-collapse:collapse;mso-padding-alt:0in 5.25pt 0in 5.25pt'>
 <tr>
  <td width=136 valign=top style='width:81.35pt;padding:0in 5.25pt 0in 5.25pt'>
  <p class=H3 style='page-break-after:auto'><span style='color:black'>See Also<o:p></o:p></span></p>
  </td>
  <td width=660 valign=top style='width:5.5in;padding:0in 5.25pt 0in 5.25pt'>
  <p class=MsoNormal>ADir(), CtoD(), Date(), DateTime(), Day(), DoW(), DMY(),
  DtoC(), GoMonth(), MDY(), Month(), Set Century, Set Date, Set Hours, Set Mark
  To, Set Seconds, Set StrictDate, Year()<o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
